(this["webpackJsonpmajiba-ui"]=this["webpackJsonpmajiba-ui"]||[]).push([[0],{127:function(e,t,n){},128:function(e,t,n){},131:function(e,t,n){"use strict";n.r(t);var a=n(3),c=n(0),i=n(11),o=n.n(i),r=n(23),s=n(9),l=n(7),j=n(87),u=n(14),d=Object(r.b)({key:"user-state",default:{token:void 0,authenticated:!1,givenName:void 0}}),b=n(182),O=n(183),m=n(184),p=n(61),h=n(132),v=n(185),x=n(177),f=n(79),k=n.n(f),g=n(168);var y=function(e){return e.status?Object(a.jsx)("div",{className:k()("waiting"),children:Object(a.jsx)("div",{className:"circular",children:Object(a.jsx)(g.a,{color:"secondary"})})}):null},w=n(80),N=n.n(w)()("".concat(window.location.origin,"/majiba-ui/keycloak-qf.json")),C=n(81),q=n.n(C);var z=function(e){var t=q.a.create();return t.interceptors.request.use((function(t){return function(e){return function(t){return Object(s.a)(Object(s.a)({},t),{},{headers:{Authorization:"Bearer ".concat(e)},"Content-Type":"application/json;charset=utf-8",Accept:"application/json;charset=utf-8"})}}(e)(t)})),t};var A=function(){return"https://api.majiba.insee.fr"},B=n(186);var V=function(e){switch(e.status){case 666:return Object(a.jsx)(B.a,{severity:"success",className:"notification",children:"Le Diable s'en est m\xeal\xe9 !"});case 200:return Object(a.jsx)(B.a,{severity:"success",className:"notification",children:"Votre jeton est renouvel\xe9 !"});case 400:return Object(a.jsx)(B.a,{severity:"error",className:"notification",children:"Cette application n'\xe9xiste pas !"});case 403:case 401:return Object(a.jsx)(B.a,{severity:"error",className:"notification",children:"Vous n'avez pas les droits n\xe9cessaires !"});default:return null}},M=n(188),S=n(176),W=n(174),D=n(175),E=n(173);var I=function(e){var t=e.open,n=e.onConfirm,c=e.onCancel;return Object(a.jsxs)(M.a,{open:t,onClose:c,"aria-labelledby":"form-dialog-title",children:[Object(a.jsx)(E.a,{id:"form-dialog-title",children:"Renouveler votre token"}),Object(a.jsx)(W.a,{children:Object(a.jsx)(D.a,{children:"En renouvelant votre token, vous r\xe9voquerez imm\xe9diatement le pr\xe9c\xe9dent. Voulez-vous continuer ?"})}),Object(a.jsxs)(S.a,{children:[Object(a.jsx)(x.a,{variant:"contained",onClick:c,color:"primary",children:"Annuler"}),Object(a.jsx)(x.a,{variant:"contained",onClick:n,color:"secondary",children:"Renouveler"})]})]})},J=n(178),L=n(189),P=n(190),R=n(191),T=n(84),U=n.n(T),F=n(172),G=n(83);var _=function(e){var t=e.value;return t?Object(a.jsxs)(L.a,{variant:"outlined",className:"token",children:[Object(a.jsx)(P.a,{htmlFor:"outlined-adornment-amount",children:"Token"}),Object(a.jsx)(R.a,{id:"token",label:"Token",type:"text",disabled:!0,variant:"outlined",value:t,endAdornment:Object(a.jsx)(J.a,{position:"end",children:Object(a.jsx)(F.a,{"aria-label":"copy",title:"copy",onClick:function(){Object(G.a)(t)},children:Object(a.jsx)(U.a,{})})})})]}):null};n(127);function H(e){return e.length}function K(){return Object(a.jsx)(p.a,{component:"div",variant:"body1",children:"Vous n'\xeates pas encore authentifi\xe9."})}var Q=function(){var e=Object(r.c)(d),t=Object(l.a)(e,1)[0],n=t.token,i=t.authenticated,o=Object(c.useState)(!1),s=Object(l.a)(o,2),j=s[0],u=s[1],b=Object(c.useState)(""),O=Object(l.a)(b,2),m=O[0],f=O[1],k=Object(c.useState)(!1),g=Object(l.a)(k,2),w=g[0],N=g[1],C=Object(c.useState)(void 0),q=Object(l.a)(C,2),B=q[0],M=q[1],S=Object(c.useState)(void 0),W=Object(l.a)(S,2),D=W[0],E=W[1],J=Object(c.useCallback)((function(e){f(e.target.value)}),[]),L=Object(c.useCallback)((function(e){e.stopPropagation();var t=function(e){return"".concat(A(),"/application/").concat(e.replace(/\s+/g,""),"/token")}(m);N(!0),u(!1),M(void 0),E(void 0),z(n).get(t).then((function(e){var t=e.data.token;E(t),N(!1),M(200)})).catch((function(e){var t=e.response;if(N(!1),t){var n=t.status;M(n)}else M(666)}))}),[m,n]);return i?Object(a.jsxs)(h.a,{elevation:2,children:[Object(a.jsx)(y,{status:w}),Object(a.jsx)(p.a,{component:"div",variant:"h4",children:"Demande de renouvellement de jeton."}),D?Object(a.jsxs)("form",{className:"majiba-demande-token",noValidate:!0,autoComplete:"off",children:[Object(a.jsx)(p.a,{component:"p",variant:"body1",className:"warning",children:"N'oubliez de copier votre jeton dans le presse papier, \xe0 l'aide du bouton dans le champ texte avant de quitter cette page."}),Object(a.jsx)(_,{value:D})]}):Object(a.jsxs)("form",{className:"majiba-demande-token",noValidate:!0,autoComplete:"off",children:[Object(a.jsx)(p.a,{component:"p",variant:"body1",className:"warning",children:"En renouvelant le jeton de votre application aupr\xe8s de l'API MAJIBA, vous r\xe9voquez automatiquement le pr\xe9c\xe9dant, s'il existe. Votre proc\xe9dure de d\xe9ploiement automatique ne fonctionnera alors correctement que lorsque vous lui aurez adjoint le nouveau jeton."}),Object(a.jsx)(v.a,{id:"application-name",label:"Nom de l'application",variant:"outlined",onChange:J,className:"form-field"}),Object(a.jsx)(x.a,{variant:"contained",color:"primary",className:"form-button",disabled:!H(m),onClick:function(){return u(!0)},children:"Soumettre"}),Object(a.jsx)(I,{open:j,onConfirm:L,onCancel:function(){return u(!1)}}),Object(a.jsx)(V,{status:B})]})]}):Object(a.jsx)(K,{})};var X=function(){var e=Object(r.c)(d),t=Object(l.a)(e,1)[0].givenName;return t?Object(a.jsx)(p.a,{variant:"h3",children:"Bienvenue ".concat(t)}):null};n(128);var Y=function(){return Object(a.jsxs)(p.a,{component:"div",className:"accueil",children:[Object(a.jsx)(X,{}),Object(a.jsx)(Q,{})]})},Z=n(88),$=n(179),ee=n(85),te=n.n(ee),ne=n(86),ae=n.n(ne),ce=Object(Z.a)({palette:{primary:{main:te.a[500]},secondary:{main:ae.a[500]}}}),ie=(Object($.a)((function(e){return{formulaire:{padding:"10px 24px",margin:"10px 30px"},button:{padding:"6px"}}})),ce),oe=n(180),re=n(181);var se=function(e){var t=e.width,n=void 0===t?48:t,c=e.height,i=void 0===c?48:c;return Object(a.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:n,height:i,version:"1.1",viewBox:"0 0 16.933 16.933",children:Object(a.jsx)("g",{transform:"translate(0 -280.067)",children:Object(a.jsxs)("g",{children:[Object(a.jsx)("circle",{cx:"8.467",cy:"288.533",r:"8.467",fill:"#ffc400",fillOpacity:"1",stroke:"none",strokeDasharray:"none",strokeMiterlimit:"4",strokeOpacity:"0",strokeWidth:"0.288",opacity:"1"}),Object(a.jsxs)("g",{transform:"matrix(1.2079 0 0 1.13889 -30.805 -30.564)",children:[Object(a.jsxs)("g",{fillOpacity:"1",stroke:"none",strokeDasharray:"none",strokeMiterlimit:"4",strokeOpacity:"0",transform:"translate(6.095 -4.347)",children:[Object(a.jsx)("path",{fill:"#000",strokeWidth:"0.265",d:"M23.019 283.102c1.993 1.075 5.824 1.226 7.015.935l-1.503 5.413c-1.21.48-4.155.41-5.68-.635z",opacity:"1"})," ",Object(a.jsx)("ellipse",{cx:"60.685",cy:"276.968",fill:"#000",strokeWidth:"0.265",opacity:"1",rx:"5.262",ry:"1.62",transform:"rotate(6.967)"}),Object(a.jsx)("ellipse",{cx:"61.446",cy:"277.179",fill:"#1a1a1a",strokeWidth:"0.162",opacity:"1",rx:"3.263",ry:"0.979",transform:"matrix(.993 .11816 -.1245 .99222 0 0)"})]}),Object(a.jsx)("g",{children:Object(a.jsx)("path",{fill:"red",stroke:"none",strokeLinecap:"butt",strokeLinejoin:"miter",strokeOpacity:"1",strokeWidth:"0.265",d:"M30.214 278.358l-.219-2.95.896-.087 1.347 1.314c.252.138.478.045.7-.098l.838-1.564.984-.13.387 3.955c-.35.128-.644.154-1.152.163l-.187-2.05-.792.842c-.198.084-.397.165-.748.064l-.992-.66.084 1.529c-.299-.056-.848-.177-1.146-.328z"})})]})]})})})},le=Object($.a)((function(e){return{menuButton:{marginRight:e.spacing(2)},title:{flexGrow:1}}}));function je(){var e=le(),t=Object(r.c)(d),n=Object(l.a)(t,1)[0].authenticated,i=Object(c.useCallback)((function(){n?N.logout({redirectUri:"".concat(window.location.origin,"/")}):N.login({redirectUri:"".concat(window.location.protocol,"//").concat(window.location.host).concat("/majiba-ui","/accueil")})}),[n]);return Object(a.jsx)(oe.a,{position:"static",children:Object(a.jsxs)(re.a,{children:[Object(a.jsx)(F.a,{edge:"start",className:e.menuButton,color:"inherit","aria-label":"menu",children:Object(a.jsx)(se,{})}),Object(a.jsx)(p.a,{variant:"h6",className:e.title,children:"Majiba api"}),Object(a.jsx)(x.a,{onClick:i,color:"inherit",children:n?"logout":"login"})]})})}var ue=function(){var e=Object(r.c)(d),t=Object(l.a)(e,2),n=t[0],i=t[1];return Object(c.useEffect)((function(){n.authenticated||N.init().success((function(e){e&&i(Object(s.a)(Object(s.a)({},n),{},{token:N.token,givenName:N.tokenParsed.given_name,authenticated:!0}))})).error((function(e){console.log(e)}))}),[i,n]),Object(a.jsxs)(b.a,{theme:ie,children:[Object(a.jsx)(O.a,{}),Object(a.jsxs)(j.a,{children:[Object(a.jsx)(je,{}),Object(a.jsx)(m.a,{role:"main",component:"main",fixed:!0,children:Object(a.jsxs)(u.d,{children:[Object(a.jsx)(u.b,{path:"/majiba-ui/accueil",component:Y}),Object(a.jsx)(u.b,{path:"/",component:function(){return Object(a.jsx)(u.a,{to:"/majiba-ui/accueil"})}})]})})]})]})};o.a.render(Object(a.jsx)(r.a,{children:Object(a.jsx)(ue,{})}),document.getElementById("root"))}},[[131,1,2]]]);
//# sourceMappingURL=main.6d69c281.chunk.js.map